# Railway Configuration for Investracker Backend
# This file tells Railway how to build and run the FastAPI backend
# NOTE: Railway root directory is set to "backend" in the dashboard,
# so all paths here are relative to the backend folder

[build]
builder = "NIXPACKS"
buildCommand = "pip install -r requirements.txt"

[deploy]
startCommand = "alembic upgrade head && uvicorn app.main:app --host 0.0.0.0 --port $PORT"
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Cron jobs will be configured through Railway dashboard
# Example cron jobs you can add later (paths relative to backend folder):

# Daily portfolio value update (midnight UTC)
# [[crons]]
# schedule = "0 0 * * *"
# command = "python -m app.tasks.update_portfolio_values"

# Fetch latest stock prices (every 15 minutes during market hours)
# [[crons]]
# schedule = "*/15 9-16 * * 1-5"
# command = "python -m app.tasks.fetch_stock_prices"

# Generate weekly reports (Sundays at 10 PM UTC)
# [[crons]]
# schedule = "0 22 * * 0"
# command = "python -m app.tasks.generate_weekly_report"
